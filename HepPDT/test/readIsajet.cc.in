// ----------------------------------------------------------------------
// readIsajet.cc
// Author: Lynn Garren
//
// read the isajet particle and decay tables for testing purposes
// note that isaparticles.dat was created with PRTLST(...)
//
// Usage:  readIsajet 
//
// ----------------------------------------------------------------------

#include <fstream>

#include "CLHEP/HepPDT/defs.h"
#include "CLHEP/HepPDT/DefaultConfig.hh"
#include "CLHEP/HepPDT/TableBuilder.hh"
#include "CLHEP/HepPDT/ParticleDataTableT.hh"

using std::cout;
using std::cerr;
using std::endl;

#ifdef __osf__
// kludge so linker can find HepPDT::DMFactory<DefaultConfig>::_inst 
template class HepPDT::DMFactory<DefaultConfig>;
#endif

int main()
{
    char pdgfile[300] = "@top_srcdir@/examples/data/isaparticles.dat";
    char decaydat[300] = "@top_srcdir@/examples/data/isadecay.dat";
    const char outfile[] = "readIsajet.out";
    // construct empty PDT
    DefaultConfig::ParticleDataTable datacol( "Isajet Table" );
    {
	// open input files
	std::ifstream pdfile( pdgfile );
	if( !pdfile ) { 
	  cerr << "cannot open " << pdgfile << endl;
	  exit(-1);
	}
	std::ifstream dcyfile( decaydat );
	if( !dcyfile ) { 
	  cerr << "cannot open " << pdgfile << endl;
	  exit(-1);
	}
        // Construct table builder
        HepPDT::TableBuilder  tb(datacol);
	// read the input - put as many here as you want
	if( !HepPDT::addIsajetParticles( pdfile, tb ) ) { cout << "error reading " << pdgfile << endl; }
	if( !HepPDT::addIsajetDecay( dcyfile, tb ) ) { cout << "error reading " << decaydat << endl; }
    }	// the tb destructor fills datacol
    std::ofstream wpdfile( outfile );
    if( !wpdfile ) { 
      cerr << "cannot open " << outfile << endl;
      exit(-1);
    }
    datacol.writeParticleData(wpdfile);
    wpdfile << std::endl;

    // output some pion information
    DefaultConfig::ParticleData * pd;
    pd=datacol.particle(HepPDT::ParticleID(111));
    if(pd) pd->write(wpdfile);
    //  -111 is an illegal particle, no info will be written
    pd=datacol.particle(HepPDT::ParticleID(-111));
    if(pd) pd->write(wpdfile);
    pd=datacol.particle(HepPDT::ParticleID(211));
    if(pd) pd->write(wpdfile);
    // string lookup
    pd=datacol.particle(std::string("pi0"));
    if(pd) pd->write(wpdfile);
    // particle info
    datacol.writeParticleInfo(wpdfile);
    
    return 0;
}
